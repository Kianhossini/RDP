name: RDP

on:
  workflow_dispatch:

jobs:
  windows-job:
    runs-on: windows-latest
    timeout-minutes: 30

    steps:
      - name: Show System Info
        run: |
          systeminfo

      - name: PowerShell Test
        run: |
          Write-Host "Workflow RDP started successfully"
          Write-Host "User: $env:USERNAME"
          Write-Host "Computer: $env:COMPUTERNAME"
          Write-Host "Date: $(Get-Date)"

      - name: Create Test User (Safe)
        run: |
          $username = "rdp_test"
          $password = ConvertTo-SecureString "Test@1234" -AsPlainText -Force

          if (-not (Get-LocalUser -Name $username -ErrorAction SilentlyContinue)) {
            New-LocalUser -Name $username -Password $password
            Write-Host "User created"
          } else {
            Write-Host "User already exists"
          }

      - name: Finish
        run: |
          Write-Host "RDP workflow finished successfully âœ…"
